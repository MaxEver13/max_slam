<launch>
    <arg name="lidar_frame_id" default="base_link"/>  <!--跟baselink 保持同一坐标系 -->
    <arg name="imu_frame_id" default="imu_link"/>
    <arg name="world_frame_id" default="map"/>
    <arg name="baselink_frame_id" default="base_link"/>
    <arg name="odometry_frame_id" default="odom"/>
    

    
    <!--地面点云分割节点-->
    <node pkg="max_slam" type="ground_seg_node" name="ground_seg_node" output="screen">
        <rosparam command="load" file="$(find max_slam)/config/segmentation_params.yaml"/>
        <param name="input_topic" value="/points_raw" />  <!--修改了tpoic的名称/kitti/velo/pointcloud，使其可以读取velodyne的数据 -->
        <param name="ground_output_topic" value="/ground_cloud" />
        <param name="obstacle_output_topic" value="/obstacle_cloud" />
        <param name="lidar_frame_id" value="$(arg lidar_frame_id)" type="string"/>
    </node>


    <!--IMU Preintegration节点-->
    <node pkg="max_slam" type="imu_preintegration_node" name="imu_preintegration_node" output="screen">
        <rosparam command="load" file="$(find max_slam)/config/imu_params.yaml"/>
        <param name="odometry_frame_id" value="$(arg odometry_frame_id)" type="string"/>
        <param name="imu_topic" value="/imu_correct" />
        <param name="lidar_odom_topic_sub" value="/lidar_mapping/odometry" />
        <param name="imu_odom_topic_pub" value="/odometry/imu_incremental" />
    </node>


    <!--Transform Fusion节点-->
    <node pkg="max_slam" type="transform_fusion_node" name="transform_fusion_node" output="screen">
        <param name="lidar_frame_id" value="$(arg lidar_frame_id)" type="string"/>
        <param name="baselink_frame_id" value="$(arg baselink_frame_id)" type="string"/>
        <param name="map_frame_id" value="$(arg world_frame_id)" type="string"/>
        <param name="odometry_frame_id" value="$(arg odometry_frame_id)" type="string"/>

        <param name="lidar_odom_topic_sub" value="/lidar_mapping/odometry" />
        <param name="imu_odom_topic_sub" value="/odometry/imu_incremental" />
        <param name="imu_odom_topic_pub" value="/odometry/imu" />
        <param name="imu_path_topic_pub" value="/imu_path" />
    </node>



    <node pkg="rviz" type="rviz" name="rviz" output="screen" args="-d $(find max_slam)/rviz/max_slam.rviz"/>
</launch>
